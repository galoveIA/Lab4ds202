---
title: "Lab 4"
author: "Gabe Love"
date: "11/2/2021"
output: html_document
---

```{r setup, include=FALSE}
library(readxl)
library(tidyverse)

defense <- read_excel('cyclonesFootball2020.xlsx', sheet = 'Defensive')
offense <- read_excel('cyclonesFootball2020.xlsx', sheet = 'Offensive')
bio <- read_excel('cyclonesFootball2020.xlsx', sheet = 'Biography')
```


# Part One

## Question 1
```{r}
defense$Name <- factor(defense$Name)
defense$Opponent_Opponent <- factor(defense$Opponent_Opponent)

offense$Name <- factor(offense$Name)
offense$Opponent_Opponent <- factor(offense$Opponent_Opponent)

bio$Name <- factor(bio$Name)
```

## Question 2

```{r}
defense <- defense %>% mutate(across(c(3:11),as.numeric))

offense <- offense %>% mutate(across(c(3:12),as.numeric))

bio$Weight <- as.numeric(bio$Weight)
```

## Question 3

```{r}
bioClean <- bio %>% separate(Height, c("Feet", "Inches"), sep = '-') %>% mutate(across(c(Feet, Inches), as.numeric)) %>% mutate(Height = Feet + (Inches/12)) %>% select(-Feet) %>% select(-Inches) %>% 
  select(c(Name, Position, Height, Weight, Class, Hometown, Highschool)) 
str(bioClean)
```

## Question 4

```{r}
offClean <- offense %>% group_by(Name,Opponent_Opponent) %>% mutate(GameNumber = n()) %>% 
  mutate(GameNumber = case_when(!(row_number() %% 2 == 0)~ 1,(row_number() %% 2 == 0) ~2)) %>% ungroup()

str(offClean)

defClean <- defense %>% group_by(Name,Opponent_Opponent) %>% mutate(GameNumber = n()) %>% 
  mutate(GameNumber = case_when(!(row_number() %% 2 == 0)~ 1,(row_number() %% 2 == 0) ~2)) %>% ungroup()

str(defClean)
```

# Part Two

## Question 1

```{r}
offClean <- offClean %>% pivot_longer(cols = 3:12, names_to = "stat", values_to = "vals")
```

## Question 2

```{r}
pOffStats <- offClean %>% group_by(Name, stat) %>% summarise(totals = sum(vals)) 
```

## Question 3

```{r}
pOffStats <- pOffStats %>% drop_na()
pOffStats <- pOffStats[!(pOffStats$stat == 'GameNumber'),]

plot <- ggplot(pOffStats, aes(x = Name, y = log10(totals))) + geom_bar(stat = "identity") + facet_wrap(~stat) + theme(axis.text.x = element_text(angle = 90))
plot
```

One pattern I see is that the football team had many more people reciving than rushing for yards, but those who did rush earned more than those who received throughout the year. 
Another pattern (which makes logical sense) is anyone who gained yards passing did not gain yards in recieving.

## Question 4

```{r}
OorO <- offClean %>% filter(Opponent_Opponent == "Oregon" | Opponent_Opponent == "Oklahoma") %>% filter(stat == "Receiving_YDS") %>% drop_na()

plot <- ggplot(OorO, aes(x = Name, y = vals, color = Opponent_Opponent)) + geom_point()+ theme(axis.text.x = element_text(angle = 90))
plot
```

Iowa State had better offense against Oklahoma, because for every player that played in both games, they had more rushing yards against oklahoma in at least one of the two games than they did against Oregon.

## Question 5

```{r}
bioClean <- bioClean %>% separate(Hometown, c("City", "State"), sep = ', ')
head(bioClean)
```

## Question 6

```{r}
stateSearch <- bioClean %>% group_by(State) %>% summarise(num = n()) %>% arrange(desc(num)) %>% print
```

## Question 7 

```{r}
bDef <- defClean %>% group_by(Name) %>% select(Tackles_Solo) %>% summarise(tackles = sum(Tackles_Solo))
filter(bDef, Name == "Purdy, Brock")
mean(bDef$tackles)
```

Brock had a substantially lower performance on Defense compared to his teammate, having only 1 tackle in the whole season as opposed to the team average of 9

```{r}
bOff <- offClean %>% filter(stat == "Passing_YDS") %>% drop_na() %>% group_by(Name) %>% summarize(PassingYards = mean(vals)) %>% print
```

On offense, Brock way outperformed his other quarterbacks, averaging 229 yards a game as opposed to 39.3 and 2.55 from his teammates.
